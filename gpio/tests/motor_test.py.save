import RPi.GPIO as GPIO
import time

dirPin = 
stepPin = 
sleepPin = 
highTime = 1.0/1000.0/1000.0#time between rising and falling edge on stepPin
delayTime = 700.0/1000.0/1000.0

def move(steps, dir):
	GPIO.output(dirPin, dir > 0 ? GPIO.HIGH : GPIO.LOW)
	GPIO.output(sleepPin, GPIO.HIGH)
	for i in range(0, steps):
		GPIO.output(stepPin, HIGH)
		time.sleep(highTime)
		GPIO.output(stepPin, LOW)
		time.sleep(max(0, delay - highTime))
	GPIO.output(sleepPin, GPIO.LOW)

GPIO.setmode(GPIO.BOARD)

# Initialize to LOW
for pin in [dirPin, stepPin, sleepPin]:
	GPIO.setup(pin, GPIO.OUT, initial=GPIO.LOW)

# UI
try:
	while True:
		delay = float(raw_input("Delay between steps (milliseconds, float)? "))
		steps = raw_input("Move? ")
		forward(float(delay) / 1000.0, int(steps), 1)
		steps = raw_input("Move? ")
		backwards(float(delay) / 1000.0, int(steps), 0)
except KeyboardInterrupt:
	print("\nClosing...")

GPIO.output(sleepPin, GPIO.LOW)

GPIO.cleanup()
print("Cleaned up")
